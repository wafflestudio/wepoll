<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8">
    <title>Wepoll</title>
    <%= csrf_meta_tags %>

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js" type="text/javascript"></script>
    <![endif]-->

    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <%= stylesheet_link_tag "colorbox", :media => "all" %>
    <%= stylesheet_link_tag "users/sessions", :media => "all" %>
    <%= stylesheet_link_tag "timeline_entries", :media => "all" %>
    <%= javascript_include_tag "application" %>
    <%= yield :scripts %>
    <script type="text/javascript">
      $(document).ready(function() {
        //notification bars
        <% [:notice, :error, :alert].each do |level| %>
          <% unless flash[level].blank? %>
            $.gritter.add({title:" ",text:"<%= flash[level]%>"});
          <% end %>
        <% end %>
      });
      $("input#query").autocomplete({
        source: search_source,
        delay: 50, 
        max: 10,
        autoFocus: true,
        select: function(event, ui) {
        $("#query_hidden").val(ui.item.query);
        $("#query_type").val(ui.item.type);
        $("#query").val(ui.item.form);
        return false;
        },
        focus: function() {return false;}}); 
    </script>

    <!-- Le styles -->
    <%= stylesheet_link_tag    "application", :media => "all" %>

    <!-- Le fav and touch icons -->
    <!--    <link href="images/favicon.ico" rel="shortcut icon">-->
    <!--    <link href="images/apple-touch-icon.png" rel="apple-touch-icon">-->
    <!--    <link href="images/apple-touch-icon-72x72.png" rel="apple-touch-icon" sizes="72x72">-->
    <!--    <link href="images/apple-touch-icon-114x114.png" rel="apple-touch-icon" sizes="114x114">-->
  </head>
  <body>
    <div id="fb-root"></div>
    <script src="//connect.facebook.net/en_US/all.js"></script>
    <script>
      FB.init({
        appId      : '<%= FACEBOOK_CLIENT[:key]%>', // App ID
        channelUrl : '//wepoll.dev/channel.html', // Channel File
        status     : true, // check login status
        cookie     : true, // enable cookies to allow the server to access the session
        xfbml      : true  // parse XFBML
      });
    </script>
    <div class="top-bar">
      top-bar
    </div>

    <div id="container" class="container_16 clearfix">

      <div class="grid_16 clearfix">

        <div id="main-content" class="grid_12 alpha">
          <% if @big_header -%>
          <div id="header" class="clearfix">
            <div id="logo-wrapper" class="prefix_1 grid_3">
              <a href="/"><h1 class="grid_3 alpha omega">logo here</h1></a>
              <%#= link_to "타임라인 바로가기", timeline_entries_path %>
            </div>

            <div id="search-bar-wrapper" class="prefix_1 grid_5" style="z-index: 2000">
              <%= form_tag "/search", :id => "main-search-bar" do |f| %>
                <%= hidden_field_tag :search_pass, "true" %>
                <%= text_field_tag :query,"", :placeholder => flash[:search].nil? ? "정치인, 동 이름을 입력하세요" : flash[:search], :autocomplete => "off" %>
                <%= hidden_field_tag :query_hidden %>
                <%= hidden_field_tag :query_type %>
                <%= submit_tag "검색"%>
              <% end -%>
            </div>
          </div>
          <% else -%>
          <div id="header-small" class="clearfix">
            <div id="logo-wrapper-small" class="grid_2">
              <a href="/"><h1 class="grid_3 alpha omega">logo here</h1></a>
            </div>

            <div id="search-bar-wrapper-small" class="grid_5">
              <%= form_tag "/search", :id => "main-search-bar" do |f| %>
                <%= hidden_field_tag :search_pass, "true" %>
                <%= text_field_tag :query,"", :placeholder => flash[:search].nil? ? "정치인, 동 이름을 입력하세요" : flash[:search], :autocomplete => "off" %>
                <%= hidden_field_tag :query_hidden %>
                <%= hidden_field_tag :query_type %>
                <%= submit_tag "검색"%>
              <% end -%>
            </div>
          </div>
          <% end -%>


          <div class="grid_12 alpha omega">
            <%= yield %>
          </div>
        </div>

        <div id="sidebar" class="grid_4 omega">
          <div class="grid_3" id="login-status">
            <%= render :partial => '/login_info' %>
          </div>
          <div class="clear"></div>

          <%= yield :sidebar %>
          <%# TODO 조건 검사? %>
          <% if @recent_timeline_entries && @popular_timeline_entries && !current_page?(:controller => :timeline_entries) && !current_page?(:action => :forum) && !current_page?(:controller => :dashboard) %>
            <%= render :partial => '/main/recent_links' %>
          <% end -%>
        </div>

      </div> <!-- end of content -->

    </div> <!-- /container -->
    <footer>
      <div class="container_16">
        <%= render :partial => '/layouts/footer' %>
      </div>
    </footer>

  </body>
</html>
